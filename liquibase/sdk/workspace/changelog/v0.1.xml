<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.0.xsd">
    <changeSet id="201507140851" author="vmakarenko">
        <comment>
            Init 1
        </comment>
        <sql>
            CREATE TABLE UNIVERSITIES (
            id uuid PRIMARY KEY,
            short_name text,
            long_name text
            );
            CREATE TABLE DEGREE_TITLES (
            id uuid PRIMARY KEY,
            short_name text,
            long_name text
            );
            CREATE TABLE USERS (
            id uuid PRIMARY KEY,
            first_name text,
            second_name text,
            passport_series text,
            passport_no text,
            university_id uuid REFERENCES UNIVERSITIES(ID),
            title_id uuid REFERENCES DEGREE_TITLES(ID)
            );
        </sql>
    </changeSet>
    <changeSet id="201507152339" author="vmakarenko">
        <comment>
            Init 2
        </comment>
        <sql>
            ALTER TABLE USERS ADD COLUMN password text;
            ALTER TABLE USERS ADD COLUMN email text;
        </sql>

    </changeSet>
    <changeSet id="201507162005" author="vmakarenko">
        <comment>
            Init 3
        </comment>
        <sql>
            ALTER TABLE USERS ADD COLUMN user_type text;
            ALTER TABLE USERS RENAME COLUMN second_name TO last_name;

            INSERT INTO UNIVERSITIES (id, short_name, long_name)
            VALUES ('00000000-0000-0000-0000-000000000000', 'МАИ', 'Московский авиационный институт (Государственный Технический Университет)');

            INSERT INTO DEGREE_TITLES (id, short_name, long_name)
            VALUES ('00000000-0000-0000-0000-000000000001', 'мл. научный сотрудник', 'младший научный сотрудник');

            INSERT INTO USERS ( id, first_name, last_name, passport_series,
            passport_no, university_id, title_id, password, email) VALUES
            ('00000000-0000-0000-0000-000000000002', 'Администратор', 'Администратор', '0000', '000000',
            '00000000-0000-0000-0000-000000000000', '00000000-0000-0000-0000-000000000001', 'admin', 'admin@test.ru');

            INSERT INTO USERS ( id, first_name, last_name, passport_series,
            passport_no, university_id, title_id, password, email) VALUES
            ('00000000-0000-0000-0000-000000000003', 'Пользователь', 'Пользователь', '0001', '000111',
            '00000000-0000-0000-0000-000000000000', '00000000-0000-0000-0000-000000000001', 'test', 'test@test.ru');
        </sql>
    </changeSet>
    <changeSet id="201507162008" author="vmakarenko">
        <comment>
            Init 4
        </comment>
        <sql>
            UPDATE USERS SET user_type = 'ADMIN'
            WHERE id = '00000000-0000-0000-0000-000000000002';
            UPDATE USERS SET user_type = 'MEMBER'
            WHERE id = '00000000-0000-0000-0000-000000000003';
        </sql>
    </changeSet>
    <changeSet id="201507181405" author="vmakarenko">
        <comment>
            added messages for internal exchange
        </comment>
        <sql>
            CREATE TABLE MESSAGES (
            id uuid PRIMARY KEY,
            from_user_id uuid REFERENCES USERS(id),
            to_user_id uuid REFERENCES USERS(id),
            msg text
            );
        </sql>
    </changeSet>
    <changeSet id="201507181408" author="vmakarenko">
        <comment>
            add patronymic for users
        </comment>
        <sql>
            ALTER TABLE users ADD COLUMN
            patronymic text;
        </sql>
    </changeSet>
    <changeSet id="201507302157" author="vmakarenko">
        <comment>
            added table for email messages
        </comment>
        <sql>
            CREATE TABLE EMAIL_MESSAGES (
            id uuid PRIMARY KEY,
            to_addr text,
            is_sent boolean,
            msg_title text,
            msg_text text
            );
        </sql>
    </changeSet>
    <changeSet id="201507302159" author="vmakarenko">
        <comment>
            added table for email templates
        </comment>
        <sql>
            CREATE TABLE EMAIL_TEMPLATES (
            id uuid PRIMARY KEY,
            name text,
            template_text text
            );
        </sql>
    </changeSet>
    <changeSet id="201507302238" author="vmakarenko">
        <comment>
            added table for settings
        </comment>
        <sql>
            CREATE TABLE APP_SETTINGS (
            id uuid PRIMARY KEY,
            key text,
            value text
            );
            insert into app_settings (id, key, value) values ('00000000-0000-0000-0000-000000000004', 'mail.my.username', 'mai.conference');
            insert into app_settings (id, key, value) values ('00000000-0000-0000-0000-000000000005', 'mail.my.address', 'mai.conference@yandex.ru');
            insert into app_settings (id, key, value) values ('00000000-0000-0000-0000-000000000006', 'mail.my.password', 'umc806');
            insert into app_settings (id, key, value) values ('00000000-0000-0000-0000-000000000007', 'mail.my.host', 'smtp.yandex.ru');
            insert into app_settings (id, key, value) values ('00000000-0000-0000-0000-000000000008', 'mail.my.security', 'SSL');
            insert into app_settings (id, key, value) values ('00000000-0000-0000-0000-000000000009', 'mail.my.port', '465');
        </sql>
    </changeSet>
</databaseChangeLog>